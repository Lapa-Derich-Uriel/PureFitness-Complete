@model PureFitness.Models.EquipmentSchedule
@{
    var equipments = ViewBag.Equipments as List<PureFitness.Models.Equipment>;
    var staffs = ViewBag.Staffs as List<PureFitness.Models.Staff>;
}

<form id="ScheduleForm" asp-action="CreateSchedule" method="post">
    @Html.AntiForgeryToken()
    <div class="modal-header">
        <h5 class="modal-title fw-semibold">Add Preventive Equipment Schedule</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
    </div>

    <div class="modal-body">
        <!-- Equipment -->
        <div class="mb-3">
            <label for="EquipmentId" class="form-label">Equipment</label>
            <select id="EquipmentId" name="EquipmentId" class="form-select" required>
                <option value="" disabled selected>Select equipment</option>
                @foreach (var eq in equipments!)
                {
                    <option value="@eq.EquipmentId">@eq.EquipmentName</option>
                }
            </select>
        </div>

        <!-- Assigned Staff -->
        <div class="mb-3">
            <label for="StaffId" class="form-label">Assigned Staff</label>
            <select id="StaffId" name="StaffId" class="form-select" required>
                <option value="" disabled selected>Select staff</option>
                @foreach (var s in staffs!)
                {
                    <option value="@s.StaffId">@s.Name</option>
                }
            </select>
        </div>

        <!-- Maintenance Date -->
        <div class="mb-3">
            <label for="MaintenanceDate" class="form-label">Start Maintenance Date</label>
            <input type="date" id="MaintenanceDate" name="MaintenanceDate" class="form-control" required />
        </div>

        <!-- Repeat Type -->
        <div class="mb-3">
            <label for="Frequency" class="form-label">Schedule Frequency</label>
            <select id="Frequency" name="Frequency" class="form-select">
                <option value="" selected>-- Select Frequency --</option>
                <option value="Daily">Daily</option>
                <option value="Weekly">Weekly</option>
                <option value="Monthly">Monthly</option>
                <option value="Quarterly">Quarterly</option>
                <option value="Semi-Annual">Semi-Annual</option>
                <option value="Annual">Annual</option>
            </select>
        </div>

        <!-- Custom Repeat Input -->
        <div id="customRepeatWrap" class="mb-3 d-none">
            <label for="CustomRepeatValue" class="form-label">Custom Interval</label>
            <input type="text" id="CustomRepeatValue" name="CustomRepeatValue" class="form-control"
                   placeholder="e.g. Every 10 days, Every 2 weeks" />
        </div>

        <!-- Remarks -->
        <div class="mb-3">
            <label for="Remarks" class="form-label">Remarks</label>
            <textarea id="Remarks" name="Remarks" class="form-control" rows="3" placeholder="Optional remarks..."></textarea>
        </div>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-dark">Save</button>
    </div>
</form>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Show or hide the custom repeat input
            $('#RepeatType').on('change', function () {
                if ($(this).val() === 'Custom') {
                    $('#customRepeatWrap').removeClass('d-none');
                    $('#CustomRepeatValue').prop('required', true);
                } else {
                    $('#customRepeatWrap').addClass('d-none');
                    $('#CustomRepeatValue').prop('required', false);
                    $('#CustomRepeatValue').val('');
                }
            });
        });
    </script>
}
